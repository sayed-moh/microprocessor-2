byte arr[] = {};
byte Zero[]   = {B00000000,B00101000,B10101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int zero_size =  23;
byte One[]    = {B10101000,B10100100,B10101100,B10100010,B10101010,B10100110,B10101110,B10100001,B10101001,B00100101,B10100101,B01100101,B00101000,B00100100};
int one_size = 14 ;
byte Two[]    = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B00010100,B00011100,B00010010,B00011010,B11101010,B01101010,B10101010,B00101010,B11001010,B01001010,B01000110,B01001110,B01000001,B01001001,B11001001,B00101001,B10101001,B01101001,B11101001,B00011001,B00000000};
int two_size = 27 ;
byte Three[]  = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B00010100,B00011100,B00010010,B00011010,B11101010,B01101010,B10101010,B00101010,B11001010,B01001010,B00010110,B00011110,B00010001,B00011001,B11101001,B01101001,B10101001,B00101001,B11001001,B01001001,B00000000};
int three_size = 27;
byte Four[]   = {B00000000,B01001000,B11101000,B01000100,B11100100,B01001100,B11101100,B01000010,B11000010,B00100010,B10100010,B01100010,B11100010,B11101010,B11100110,B11101110,B11100001,B11101001,B00000000};
int four_size = 17;
byte Five[]   = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B01000100,B01001100,B01000010,B01001010,B11001010,B00101010,B10101010,B01101010,B11101010,B00011010,B00010110,B00011110,B00010001,B01001001,B11001001,B00101001,B10101001,B01101001,B11101001,B00011001,B00000000};
int five_size = 27;
byte Six[]    = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B01000100,B01001100,B01000010,B01001010,B11001010,B00101010,B10101010,B01101010,B11101010,B00011010,B00010110,B00011110,B00010001,B01001001,B11001001,B00101001,B10101001,B01101001,B11101001,B00011001,B01000110,B01001110,B01000001,B00000000};
int six_size = 30;
byte Seven[]  = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B00010100,B00011100,B00010010,B00011010,B00010110,B00011110,B00010001,B00011001,B00000000}; 
int seven_size = 15;
byte Eight[]  = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B01000100,B01001100,B01000010,B01001010,B11001010,B00101010,B10101010,B01101010,B11101010,B00011010,B00010110,B00011110,B00010001,B01001001,B11001001,B00101001,B10101001,B01101001,B11101001,B00011001,B01000110,B01001110,B01000001,B00010100,B00011100,B00010010,B00000000}; 
int eight_size = 33;
byte Nine[] = {B00000000,B01001000,B11001000,B00101000,B10101000,B01101000,B11101000,B00011000,B01000100,B01001100,B01000010,B01001010,B11001010,B00101010,B10101010,B01101010,B11101010,B00011010,B00010110,B00011110,B00010001,B01001001,B11001001,B00101001,B10101001,B01101001,B11101001,B00011001,B00010100,B00011100,B00010010,B00000000};
int nine_size = 30;
byte Zero_emoji[] = {B00000000,B00100010,B11100010,B00101110,B10100001,B01100001,B11101110,B10101000,B00101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int zero_emoji_size =  30;
byte One_emoji[] = {B00000000,B00100010,B11100010,B00100001,B10100001,B01100001,B11100001,B10101000,B00101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int one_emoji_size =  30;
byte Two_emoji[] = {B00000000,B00100010,B11100010,B00100001,B10101110,B01101110,B11100001,B10101000,B00101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int two_emoji_size =  30;
byte Three_emoji[]={B00000000,B01011000,B10010100,B00011100,B11100010,B01101010,B10100110,B00101110,B11000001,B11001110,B11000110,B11001010,B00000000};
int three_emoji_size=11;
byte Four_emoji[]={B00000000,B00100100,B10100100,B01100100,B11100100,B00100010,B11100010,B00101110,B10100001,B01100001,B11101110,B10101000,B00101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int four_emoji_size=34;
byte Five_emoji[]= {B00000000,B10101100,B00100100,B01100100,B11001000,B11101000,B01000100,B00010100,B10001100,B10011100,B01000010,B00010010,B11001010,B11101010,B00100110,B01100110,B10101110,B00000000};
int five_emoji_size=16;
byte Six_emoji[]={B00000000,B10100010,B10101010,B10100110,B10101100,B00100100,B01100100,B11001000,B11101000,B01000100,B00010100,B10001100,B10011100,B01000010,B00010010,B11001010,B11101010,B00100110,B01100110,B10101110,B00000000};
int six_emoji_size=18;
byte Seven_emoji[]={B00000000,B01011000,B10010100,B00011100,B11100010,B01101010,B10100110,B00101110,B11000001,B01001001,B10000101,B10001000,B01000100,B11001100,B00100010,B10101010,B01100110,B11101110,B00010001,B10011001,B01010101,B00000000};
int seven_emoji_size=19;
byte Eight_emoji[]={B00000000,B11000010,B00100010,B11100010,B00010010,B10101110,B01101110,B00101000,B10101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int eight_emoji_size=30;
byte Nine_emoji[]={B00000000,B00100010,B11100010,B10100001,B01100001,B00101000,B10101000,B01101000,B11101000,B11000100,B00010100,B01001100,B10011100,B01000010,B10010010,B01001010,B10011010,B01000110,B10010110,B01001110,B10011110,B01000001,B10010001,B11001001,B00011001,B00100101,B10100101,B01100101,B11100101,B00000000}; 
int nine_emoji_size=28;
int c=0;
int previousmillis=0;
int mode=0;
int number_draw[]={-1,-1,-1,-1};
int size_pass=0;
int key=-1;
int exit1=-1;
int pass[]={1,2,3,4};
void setup() 
{
  Serial.begin(9600);
  for(int i=4;i<12;i++)
  {
    pinMode(i,OUTPUT);
  }
  pinMode(3,OUTPUT);
  pinMode(0,INPUT);
  pinMode(1,INPUT);
  pinMode(2,INPUT);
  pinMode(13,INPUT);
  pinMode(12,INPUT);
  pinMode(A0,INPUT);
  pinMode(A1,INPUT);
  pinMode(A2,INPUT);
  pinMode(A3,INPUT);
  pinMode(A4,INPUT);
  pinMode(A5,INPUT);
  self_test_row();
  self_test_col();
  attachInterrupt(digitalPinToInterrupt(2),Active,RISING);
}
///////////////////////////////////////////////////////////////////////////////////
void loop()
{
  recieve_key(key);
}
///////////////////////////////////////////////////
void self_test_row()
{ 
    for(int i=1;i<11;i++)
  {
      digitalWrite(8,bitRead(i,0));
      digitalWrite(9,bitRead(i,1));
      digitalWrite(10,bitRead(i,2));
      digitalWrite(11,bitRead(i,3));
      int p=millis();
      for(int k=0;k<1000;k++)
      {
      for(int j=1;j<11;j++)
      {
      digitalWrite(4,bitRead(j,0));
      digitalWrite(5,bitRead(j,1));
      digitalWrite(6,bitRead(j,2));
      digitalWrite(7,bitRead(j,3));
      delay(1);
       }
       if(millis()-p>200)
       break;
      }
    digitalWrite(4, LOW); 
    digitalWrite(5, LOW); 
    digitalWrite(6, LOW);
    digitalWrite(7, LOW);
    
  }
}
///////////////////////////////////////////////////////////////////////////////////////
void self_test_col()
{
    for(int i=1;i<11;i++)
  {
      digitalWrite(4,bitRead(i,0));
      digitalWrite(5,bitRead(i,1));
      digitalWrite(6,bitRead(i,2));
      digitalWrite(7,bitRead(i,3));
      int p=millis();
      for(int k=0;k<1000;k++)
      {
      for(int j=1;j<11;j++)
      {
      digitalWrite(8,bitRead(j,0));
      digitalWrite(9,bitRead(j,1));
      digitalWrite(10,bitRead(j,2));
      digitalWrite(11,bitRead(j,3));
      delay(1);
       }
        if(millis()-p>200)
       break;
      }
    digitalWrite(8, LOW); 
    digitalWrite(9, LOW); 
    digitalWrite(10, LOW);
    digitalWrite(11, LOW);

    }
  }
  ////////////////////////////////////////////////////////////////////////////////////////
void read_array(byte b)
{
  digitalWrite(4,(b)& B10000000);
  digitalWrite(5,(b)& B01000000);
  digitalWrite(6,(b)& B00100000);
  digitalWrite(7,(b)& B00010000);
  digitalWrite(8,(b)& B00001000);
  digitalWrite(9,(b)& B00000100);
  digitalWrite(10,(b)& B00000010);
  digitalWrite(11,(b)& B00000001);
  }
  //////////////////////////////////////////////////////////////////////////////////////////////
  void Read_Number(int s,byte number[])
{
  //this is for the step by step led but i think it makes something wrong in the code
//  previousmillis=millis();
//   for(int i=0;i<s+2;i)
//   {
//    if((millis()-previousmillis)>200)
//    {  i++;
//       for(int j=0;j<i;j++)
//       {
//       read_array(number[j]);
//       }
//       delayMicroseconds(200);
//       previousmillis=millis();
//    }
//     
//     for(int j=0;j<i;j++)
//       {
//       read_array(number[j]);
//       } 
//       delayMicroseconds(200);
//    
//   }
//    if(exit1==1)
//      return; 
for(int i=0;i<s+2;i++)
{
  read_array(number[i]);
  delayMicroseconds(300);
  }
 if(exit1==1)
     return;
}
////////////////////////////////////////////////////////////////////////////////////////
void getemptyelement(int arrr[],int number)
{
  arrr[size_pass]=number;
  size_pass++;
}
//////////////////////////////////////////////////////////////////////////////////////////
void recieve_key(int k)
{    
  if(mode==0)
    {
      if(k==0)
      { Read_Number(zero_size,Zero); }
      else if(k==1)
      {Read_Number(one_size,One);}
      else if(k==2)
      { Read_Number(two_size,Two); }
      else if(k==3)
      {Read_Number(three_size,Three);}
      else if(k==4)
      {Read_Number(four_size,Four);}
      else if(k==5)
      {Read_Number(five_size,Five);}
      else if(k==6)
      { Read_Number(six_size,Six);}
      else if(k==7)
      {Read_Number(seven_size,Seven);}
      else if(k==8)
      {Read_Number(eight_size,Eight);}
      else if(k==9)
      { Read_Number(nine_size,Nine);}
      else;
    }
    else if(mode==1)
    {if(k==0)
      Read_Number(zero_emoji_size,Zero_emoji);
      else if(k==1)
      {Read_Number(one_emoji_size,One_emoji);}
      else if(k==2)
      { Read_Number(two_emoji_size,Two_emoji); }
      else if(k==3)
      {Read_Number(three_emoji_size,Three_emoji);}
      else if(k==4)
      {Read_Number(four_emoji_size,Four_emoji);}
      else if(k==5)
      {Read_Number(five_emoji_size,Five_emoji);}
      else if(k==6)
      { Read_Number(six_emoji_size,Six_emoji);}
      else if(k==7)
      {Read_Number(seven_emoji_size,Seven_emoji);}
      else if(k==8)
      {Read_Number(eight_emoji_size,Eight_emoji);}
      else if(k==9)
      { Read_Number(nine_emoji_size,Nine_emoji);}
    } 
    else;
  }
  ///////////////////////////////////////////////////////////////////////////////////////
  void from_num_to_emoji(int password[])
{ 
        if(number_draw[0]==password[0] && number_draw[1]==password[1] && number_draw[2]==password[2] && number_draw[3]==password[3])
        {
          Serial.println("from numeric to emoji");
          mode=1;
          int z=number_draw[4];
          size_pass=1;
          number_draw[0]=z; 
           return;
          }
          else
          {
            Serial.println("8lt from numeric to emoji");
          int z=number_draw[4];
          size_pass=1;
          number_draw[0]=z; 
           return;
           }                                  
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void from_emoji_to_num(int password[])
{
   if(number_draw[0]==password[3] && number_draw[1]==password[2] && number_draw[2]==password[1] && number_draw[3]==password[0])
    {
      Serial.println("from emoji to numeric");
        mode=0;
        int z=number_draw[4];
        size_pass=1;
        number_draw[0]=z; 
         return;
      }
      else
      {
        Serial.println("from emoji to numeric");
        int z=number_draw[4];
        size_pass=1;
        number_draw[0]=z; 
        return;
       }
  }
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Change_Password(int password[])
{
   if((number_draw[0]==1 && number_draw[1]==2 && number_draw[2]==1 && number_draw[3]==2)||c==1)
   {
    
    if(c==1)
    {
      for(int i=0;i<4;i++)
      {
        password[i]=number_draw[i];
        }
        Serial.println("password changed");
        c=0;
        size_pass=0;
      }
      else
      {
    size_pass=0;
    c++;
    }
  }
}
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
void Active()
    { key=-1;
      exit1=1;
      if(digitalRead(A0)==HIGH)
      {getemptyelement(number_draw,0);
        key=0;
        }
      else if(digitalRead(A1)==HIGH)
      {getemptyelement(number_draw,1);
        key=1;
        }
      else if(digitalRead(A2)==HIGH)
      { getemptyelement(number_draw,2);
        key=2;
        }
      else if(digitalRead(A3)==HIGH)
      {getemptyelement(number_draw,3);
        key=3;
        }
      else if(digitalRead(A4)==HIGH)
      {getemptyelement(number_draw,4);
        key=4;
        }
      else if(digitalRead(A5)==HIGH)
      {getemptyelement(number_draw,5);
       key=5;
       }
      else if(digitalRead(0)==HIGH)
      {getemptyelement(number_draw,6);
        key=6;
        }
      else if(digitalRead(1)==HIGH)
      {getemptyelement(number_draw,7);
        key=7;
        }
      else if(digitalRead(13)==HIGH)
      {getemptyelement(number_draw,8);
      key=8;
      }
      else if(digitalRead(12)==HIGH)
      {getemptyelement(number_draw,9);
        key=9;
        }
        else;
        playTone(key);
                    if(size_pass==4 && mode==0)
                    {
                      Change_Password(pass);
                      }
                         if(size_pass==5 && mode==0)
                      {
                        from_num_to_emoji(pass);
                      }
                      else if(size_pass==5 && mode==1)
                      {
                        from_emoji_to_num(pass);
                        }
                        else;
        
        if(key!=-1)
        {exit1=-1;}
    }
    ////////////////////////////////////////////
void playTone(int t) 
{
      Serial.println("sound");
      for(int i=0;i<1000;i++)
      {
      digitalWrite(3,HIGH);
      delayMicroseconds(t*100+100);
      digitalWrite(3, LOW);
      }
                                    
}
